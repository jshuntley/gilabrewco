---
import { Image } from "astro:assets";
import ThemeToggle from "./ThemeToggle.astro";

interface Props {
  current?: string;
}

const { current = "" } = Astro.props;

const links = [
  { text: "Home", href: "/", id: "" },
  { text: "About", href: "/about", id: "about" },
  { text: "Blog", href: "/blog", id: "blog" },
] as const;
---

<header
  class="sticky top-0 z-50 w-full bg-light-base/80 dark:bg-dark-base/80 backdrop-blur-md border-b border-light-accent/10 dark:border-dark-accent/10"
>
  <nav class="mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8">
    <div class="flex lg:flex-1">
      <a
        href="/"
        class="-m-1.5 p-1.5 flex items-center gap-4"
        aria-label="Gila Brewing Co. home"
      >
        <Image
          src="/assets/images/logo.png"
          alt="Gila Brewing Co."
          width={48}
          height={48}
          class="rounded-full shadow-md"
        />
        <span
          class="hidden sm:inline-block font-serif font-bold text-2xl text-light-text dark:text-dark-text whitespace-nowrap tracking-tight"
        >
          Gila Brewing Co.
        </span>
      </a>
    </div>

    <!-- Navigation Links -->
    <div class="hidden sm:flex sm:gap-x-8">
      {
        links.map(({ text, href, id }) => {
          const isCurrentPage = current === id;
          return (
            <a
              href={href}
              class:list={[
                "font-sans text-base font-medium tracking-wide transition-colors duration-200",
                isCurrentPage
                  ? "text-light-accent dark:text-dark-accent"
                  : "text-light-text dark:text-dark-text hover:text-light-accent dark:hover:text-dark-accent",
              ]}
              aria-current={isCurrentPage ? "page" : undefined}
            >
              {text}
            </a>
          );
        })
      }
    </div>

    <div class="flex flex-1 justify-end">
      <ThemeToggle />
    </div>
  </nav>
</header>

<script>
  // Update current page indicator during transitions
  document.addEventListener("astro:page-load", () => {
    const path = window.location.pathname;
    const links = document.querySelectorAll("header nav a");

    links.forEach((link) => {
      const isCurrentPage =
        link.getAttribute("href") === path ||
        (path === "/" && link.getAttribute("href") === "/");

      link.classList.toggle("text-light-accent", isCurrentPage);
      link.classList.toggle("dark:text-dark-accent", isCurrentPage);
      link.classList.toggle("text-light-text", !isCurrentPage);
      link.classList.toggle("dark:text-dark-text", !isCurrentPage);
      link.setAttribute("aria-current", isCurrentPage ? "page" : "false");
    });
  });
</script>
